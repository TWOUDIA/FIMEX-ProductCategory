angular.module("chineselearn",["ionic","ngCookies","ngMessages","pascalprecht.translate","tmh.dynamicLocale","ionic-toast","chineselearn.controllers","chineselearn.directives","chineselearn.filters","chineselearn.services"]).run(function(e,t,a,n,r){e.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleLightContent()});var o=!1;e.registerBackButtonAction(function(e){e.preventDefault();var s=t.backView();return s?s.go():o?ionic.Platform.exitApp():(o=!0,a.show(n("translate")("CONFIRM_BEFORE_APP_EXIT"),"middle",!1,1e3),r(function(){o=!1},2e3)),!1},101)}).config(function(e,t,a,n,r){e.tabs.position("bottom"),t.localeLocationPattern("locales/angular-locale_{{locale}}.js"),a.useStaticFilesLoader({prefix:"i18n/",suffix:".json"}).registerAvailableLanguageKeys(["ar","bn","de","en","es","fr","hi","id","ja","ms","pt","ru","ur","zh"],{ar:"ar","ar_*":"ar",bn:"bn","bn_*":"bn",de:"de","de_*":"de",en:"en","en_*":"en",es:"es","es_*":"es",fr:"fr","fr_*":"fr",hi:"hi","hi_*":"hi",id:"id","id_*":"id",ja:"ja","ja_*":"ja",ms:"ms","ms_*":"ms",pt:"pt","pt_*":"pt",ru:"ru","ru_*":"ru",ur:"ur","ur_*":"ur",zh:"zh","zh_*":"zh"}).preferredLanguage("de").fallbackLanguage(["en","zh","es","fr"]).determinePreferredLanguage().useSanitizeValueStrategy("escapeParameters").useLocalStorage(),n.state("tab",{url:"/tab","abstract":!0,templateUrl:"templates/tabs.html"}).state("tab.dash",{url:"/dash",views:{"tab-dash":{templateUrl:"templates/tab-dash.html",controller:"DashCtrl"}}}).state("tab.posts",{url:"/posts",cache:!1,views:{"tab-posts":{templateUrl:"templates/tab-posts.html",controller:"PostsCtrl"}}}).state("tab.post-detail",{url:"/posts/:postId",views:{"tab-posts":{templateUrl:"templates/post-detail.html",controller:"PostDetailCtrl"}}}).state("tab.tags",{url:"/tags",cache:!1,views:{"tab-tags":{templateUrl:"templates/tab-tags.html",controller:"TagsCtrl"}}}).state("tab.tag-posts",{url:"/tagposts/:tagSlug/:tagName",views:{"tab-posts":{templateUrl:"templates/tab-posts.html",controller:"PostsCtrl"}}}).state("tab.categories",{url:"/categories",cache:!1,views:{"tab-categories":{templateUrl:"templates/tab-categories.html",controller:"CategoriesCtrl"}}}).state("tab.category-posts",{url:"/categoryposts/:categorySlug/:categoryName",views:{"tab-posts":{templateUrl:"templates/tab-posts.html",controller:"PostsCtrl"}}}).state("tab.account",{url:"/account",views:{"tab-account":{templateUrl:"templates/tab-account.html",controller:"AccountCtrl"}}}),r.otherwise("/tab/dash")}),angular.module("chineselearn.controllers",[]).controller("DashCtrl",function(e){}).controller("PostsCtrl",function(e,t,a,n,r,o,s,l){s.show({template:o("translate")("LOADING_TEXT")}),e.RSempty=!1;var i;a.tagSlug?(i="?filter[tag]="+a.tagSlug,e.termQS={Type:"TAB_TITLE_TAGS",Term:a.tagName}):a.categorySlug?(i="?filter[category_name]="+a.categorySlug,e.termQS={Type:"TAB_TITLE_CATEGORIES",Term:a.categoryName}):i="",e.loadPosts=function(){t.get("posts"+i).then(function(t){e.posts=t.data,s.hide()},function(t){r.error("error",t),s.hide(),e.RSempty=!0})},e.loadPosts(),e.doRefresh=function(){n(function(){s.show({template:o("translate")("LOADING_TEXT")}),e.loadPosts()},1e3)}}).controller("PostDetailCtrl",function(e,t,a,n,r,o,s,l){l.show({template:s("translate")("LOADING_TEXT")}),e.RSempty=!1,e.loadPost=function(){a.get("posts/"+t.postId).then(function(t){e.post=t.data,e.content=n.trustAsHtml(t.data.content.rendered),l.hide()},function(e){o.error("error",e),l.hide()})},e.loadPost(),e.doRefresh=function(){r(function(){e.loadPost()},1e3)}}).controller("TagsCtrl",function(e,t,a,n,r,o){o.show({template:r("translate")("LOADING_TEXT")}),e.RSempty=!1,e.loadTags=function(){t.get("tags").then(function(t){e.tags=t.data,o.hide()},function(t){n.error("error",t),o.hide(),e.RSempty=!0})},e.loadTags(),e.doRefresh=function(){a(function(){e.loadTags()},1e3)}}).controller("CategoriesCtrl",function(e,t,a,n,r,o){o.show({template:r("translate")("LOADING_TEXT")}),e.RSempty=!1,e.loadCategories=function(){t.get("categories").then(function(t){e.categories=t.data,o.hide()},function(t){n.error("error",t),o.hide(),e.RSempty=!0})},e.loadCategories(),e.doRefresh=function(){a(function(){e.loadCategories()},1e3)}}).controller("AccountCtrl",function(e,t,a,n,r,o,s,l){e.forms={},e.ctForm={},e.settings={enableFriends:!0,language:t.use()},e.$watch("settings.language",function(){n.change("language",e.settings.language),r.clearCache(),r.clearHistory()}),e.formSubmit=function(){var t={key:n.get("emailserviceKey"),message:{html:e.ctForm.ctMessage,text:e.ctForm.ctMessage,subject:"Message sent via Mobile APP - ChineseLearn.info, "+s("date")(Date.now(),"yyyy-MM-dd HH:mm:ss Z"),from_email:e.ctForm.ctEmail,from_name:e.ctForm.ctName,to:[{email:n.get("contactForm2Email"),name:n.get("contactForm2User"),type:"to"}],important:!1,track_opens:null,track_clicks:null,auto_text:null,auto_html:null,inline_css:null,url_strip_qs:null,preserve_recipients:null,view_content_link:null,tracking_domain:null,signing_domain:null,return_path_domain:null},async:!1,ip_pool:"Main Pool"};o.send(t),alert(s("translate")("ALERT_MAIL_SENT",{name:e.ctForm.ctName})),e.ctForm={},e.forms.contactForm.$setPristine()}}),angular.module("chineselearn.directives",[]).directive("gpRadio",function(){return{restrict:"A",require:"ngModel",scope:{model:"=ngModel",value:"=gpRadio"},link:function(e,t,a,n){t.addClass("button"),t.on("click",function(t){e.$apply(function(){n.$setViewValue(e.value)})}),e.$watch("model",function(a){t.removeClass("button-positive"),a===e.value&&t.addClass("button-positive")})}}}),angular.module("chineselearn.filters",[]).filter("linkremove",function(e,t){return function(t){var a=document.createElement("div");a.innerHTML=t;for(var n=a.getElementsByTagName("a"),r=n.length;r>0;r--)n[r-1].parentNode.removeChild(n[r-1]);return e.trustAsHtml(a.outerHTML)}}).filter("linkremove_imagelazyload",function(e,t){return function(t){var a=document.createElement("div");a.innerHTML=t;for(var n=a.getElementsByTagName("a"),r=n.length;r>0;r--)n[r-1].parentNode.removeChild(n[r-1]);for(var o=a.getElementsByTagName("img"),r=0;r<o.length-1;r++)o[r].setAttribute("image-lazy-src",o[r].getAttribute("src")),o[r].setAttribute("lazy-scroll-resize",!0),o[r].removeAttribute("src");return e.trustAsHtml(a.outerHTML)}}).filter("unicode",function(e){return function(t){return e.trustAsHtml(t)}}),angular.module("chineselearn.services",[]).factory("DataLoader",function(e,t,a){return{get:function(n){var r=a.getURI()+n;return t.debug("URL: "+r),e.get(r)}}}).factory("EmailSender",function(e,t,a){return{send:function(n){return e.post(a.get("emailAPI"),n).success(function(){t.debug("successful email send.")}).error(function(){t.debug("error sending email.")}),null}}}).factory("AppSettings",function(e,t,a){function n(e){switch(e){case"en":r.languageURI="";break;case"zh":r.languageURI="zh-hant/";break;default:r.languageURI=e+"/"}}var r={domainURI:"https://chineselearn.info/",wpjsonURI:"wp-json/wp/v2/",enableFriends:!0,language:"",languageURI:"",emailserviceKey:"e8yCnUcg1OaKz0dWIhIH7w",emailAPI:"https://mandrillapp.com/api/1.0/messages/send.json",contactForm2Email:"support@chineselearn.info",contactForm2User:"Support",datdReload:!1};return r.language=e.use(),n(r.language),{change:function(o,s){r[o]=s,"language"==o&&(n(s),e.use(s),t.set(s)),a.debug(o+" : "+s)},get:function(e){return r[e]},getURI:function(){return r.domainURI+r.languageURI+r.wpjsonURI}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzLmpzIiwiZGlyZWN0aXZlcy5qcyIsImZpbHRlcnMuanMiLCJzZXJ2aWNlcy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJGlvbmljUGxhdGZvcm0iLCIkaW9uaWNIaXN0b3J5IiwiaW9uaWNUb2FzdCIsIiRmaWx0ZXIiLCIkdGltZW91dCIsInJlYWR5Iiwid2luZG93IiwiY29yZG92YSIsInBsdWdpbnMiLCJLZXlib2FyZCIsImhpZGVLZXlib2FyZEFjY2Vzc29yeUJhciIsIlN0YXR1c0JhciIsInN0eWxlTGlnaHRDb250ZW50IiwiY291bnRUaW1lckZvckNsb3NlQXBwIiwicmVnaXN0ZXJCYWNrQnV0dG9uQWN0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicHJldmlvdXNWaWV3IiwiYmFja1ZpZXciLCJnbyIsImlvbmljIiwiUGxhdGZvcm0iLCJleGl0QXBwIiwic2hvdyIsImNvbmZpZyIsIiRpb25pY0NvbmZpZ1Byb3ZpZGVyIiwidG1oRHluYW1pY0xvY2FsZVByb3ZpZGVyIiwiJHRyYW5zbGF0ZVByb3ZpZGVyIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJ0YWJzIiwicG9zaXRpb24iLCJsb2NhbGVMb2NhdGlvblBhdHRlcm4iLCJ1c2VTdGF0aWNGaWxlc0xvYWRlciIsInByZWZpeCIsInN1ZmZpeCIsInJlZ2lzdGVyQXZhaWxhYmxlTGFuZ3VhZ2VLZXlzIiwiYXIiLCJhcl8qIiwiYm4iLCJibl8qIiwiZGUiLCJkZV8qIiwiZW4iLCJlbl8qIiwiZXMiLCJlc18qIiwiZnIiLCJmcl8qIiwiaGkiLCJoaV8qIiwiaWQiLCJpZF8qIiwiamEiLCJqYV8qIiwibXMiLCJtc18qIiwicHQiLCJwdF8qIiwicnUiLCJydV8qIiwidXIiLCJ1cl8qIiwiemgiLCJ6aF8qIiwicHJlZmVycmVkTGFuZ3VhZ2UiLCJmYWxsYmFja0xhbmd1YWdlIiwiZGV0ZXJtaW5lUHJlZmVycmVkTGFuZ3VhZ2UiLCJ1c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3kiLCJ1c2VMb2NhbFN0b3JhZ2UiLCJzdGF0ZSIsInVybCIsImFic3RyYWN0IiwidGVtcGxhdGVVcmwiLCJ2aWV3cyIsInRhYi1kYXNoIiwiY29udHJvbGxlciIsImNhY2hlIiwidGFiLXBvc3RzIiwidGFiLXRhZ3MiLCJ0YWItY2F0ZWdvcmllcyIsInRhYi1hY2NvdW50Iiwib3RoZXJ3aXNlIiwiJHNjb3BlIiwiRGF0YUxvYWRlciIsIiRzdGF0ZVBhcmFtcyIsIiRsb2ciLCIkaW9uaWNMb2FkaW5nIiwidGVtcGxhdGUiLCJSU2VtcHR5IiwidGVybVF1ZXJ5U3RyaW5nIiwidGFnU2x1ZyIsInRlcm1RUyIsIlR5cGUiLCJUZXJtIiwidGFnTmFtZSIsImNhdGVnb3J5U2x1ZyIsImNhdGVnb3J5TmFtZSIsImxvYWRQb3N0cyIsImdldCIsInRoZW4iLCJyZXNwb25zZSIsInBvc3RzIiwiZGF0YSIsImhpZGUiLCJlcnJvciIsImRvUmVmcmVzaCIsIiRzY2UiLCJsb2FkUG9zdCIsInBvc3RJZCIsInBvc3QiLCJjb250ZW50IiwidHJ1c3RBc0h0bWwiLCJyZW5kZXJlZCIsImxvYWRUYWdzIiwidGFncyIsImxvYWRDYXRlZ29yaWVzIiwiY2F0ZWdvcmllcyIsIiR0cmFuc2xhdGUiLCJ0bWhEeW5hbWljTG9jYWxlIiwiQXBwU2V0dGluZ3MiLCJFbWFpbFNlbmRlciIsImZvcm1zIiwiY3RGb3JtIiwic2V0dGluZ3MiLCJlbmFibGVGcmllbmRzIiwibGFuZ3VhZ2UiLCJ1c2UiLCIkd2F0Y2giLCJjaGFuZ2UiLCJjbGVhckNhY2hlIiwiY2xlYXJIaXN0b3J5IiwiZm9ybVN1Ym1pdCIsIm1haWxKU09OIiwia2V5IiwibWVzc2FnZSIsImh0bWwiLCJjdE1lc3NhZ2UiLCJ0ZXh0Iiwic3ViamVjdCIsIkRhdGUiLCJub3ciLCJmcm9tX2VtYWlsIiwiY3RFbWFpbCIsImZyb21fbmFtZSIsImN0TmFtZSIsInRvIiwiZW1haWwiLCJuYW1lIiwidHlwZSIsImltcG9ydGFudCIsInRyYWNrX29wZW5zIiwidHJhY2tfY2xpY2tzIiwiYXV0b190ZXh0IiwiYXV0b19odG1sIiwiaW5saW5lX2NzcyIsInVybF9zdHJpcF9xcyIsInByZXNlcnZlX3JlY2lwaWVudHMiLCJ2aWV3X2NvbnRlbnRfbGluayIsInRyYWNraW5nX2RvbWFpbiIsInNpZ25pbmdfZG9tYWluIiwicmV0dXJuX3BhdGhfZG9tYWluIiwiYXN5bmMiLCJpcF9wb29sIiwic2VuZCIsImFsZXJ0IiwiY29udGFjdEZvcm0iLCIkc2V0UHJpc3RpbmUiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcXVpcmUiLCJzY29wZSIsIm1vZGVsIiwidmFsdWUiLCJsaW5rIiwiZWxlbWVudCIsImF0dHJzIiwibmdNb2RlbEN0cmwiLCJhZGRDbGFzcyIsIm9uIiwiJGFwcGx5IiwiJHNldFZpZXdWYWx1ZSIsIm5ld1ZhbCIsInJlbW92ZUNsYXNzIiwiZmlsdGVyIiwiaHRtbE9iamVjdCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImxpbmtzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJpIiwibGVuZ3RoIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwib3V0ZXJIVE1MIiwiaW1ncyIsInNldEF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIngiLCJmYWN0b3J5IiwiJGh0dHAiLCIkdGVybSIsImdldFVSSSIsImRlYnVnIiwiJG1haWwiLCJzdWNjZXNzIiwic2V0TGFuZ3VhZ2VVUkkiLCJzYXZlZERhdGEiLCJsYW5ndWFnZVVSSSIsImRvbWFpblVSSSIsIndwanNvblVSSSIsImVtYWlsc2VydmljZUtleSIsImVtYWlsQVBJIiwiY29udGFjdEZvcm0yRW1haWwiLCJjb250YWN0Rm9ybTJVc2VyIiwiZGF0ZFJlbG9hZCIsIiRpdGVtIiwic2V0Il0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxnQkFDQSxRQUNBLFlBQ0EsYUFDQSx5QkFDQSxvQkFDQSxjQUNB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SixRQUFBLGNBQUEsU0FBQW5GLEVBQUFDLEVBQUFqQyxHQWNBLFFBQUEwSCxHQUFBbkMsR0FDQSxPQUFBQSxHQUNBLElBQUEsS0FDQW9DLEVBQUFDLFlBQUEsRUFDQSxNQUNBLEtBQUEsS0FDQUQsRUFBQUMsWUFBQSxVQUNBLE1BQ0EsU0FDQUQsRUFBQUMsWUFBQXJDLEVBQUEsS0F0QkEsR0FBQW9DLElBQ0FFLFVBQUEsNkJBQ0FDLFVBQUEsaUJBQ0F2RixlQUFBLEVBQ0FDLFNBQUEsR0FDQW9GLFlBQUEsR0FDQUcsZ0JBQUEseUJBQ0FDLFNBQUEscURBQ0FDLGtCQUFBLDRCQUNBQyxpQkFBQSxVQUNBQyxZQUFBLEVBb0JBLE9BSEFSLEdBQUFuRixTQUFBUixFQUFBUyxNQUNBaUYsRUFBQUMsRUFBQW5GLFdBR0FHLE9BQUEsU0FBQXlGLEVBQUE3QyxHQUNBb0MsRUFBQVMsR0FBQTdDLEVBQ0EsWUFBQTZDLElBRUFWLEVBQUFuQyxHQUVBdkQsRUFBQVMsSUFBQThDLEdBQ0F0RCxFQUFBb0csSUFBQTlDLElBRUF2RixFQUFBdUgsTUFBQWEsRUFBQSxNQUFBN0MsSUFFQTFFLElBQUEsU0FBQXVILEdBQ0EsTUFBQVQsR0FBQVMsSUFFQWQsT0FBQSxXQUNBLE1BQUFLLEdBQUFFLFVBQUFGLEVBQUFDLFlBQUFELEVBQUFHIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhbmd1bGFyLm1vZHVsZSBpcyBhIGdsb2JhbCBwbGFjZSBmb3IgY3JlYXRpbmcsIHJlZ2lzdGVyaW5nIGFuZCByZXRyaWV2aW5nIEFuZ3VsYXIgbW9kdWxlc1xyXG5hbmd1bGFyLm1vZHVsZSgnY2hpbmVzZWxlYXJuJywgW1xyXG4gICAgJ2lvbmljJywgIC8vIGlvbmljIGZyYW1ld29ya1xyXG4gICAgJ25nQ29va2llcycsXHJcbiAgICAnbmdNZXNzYWdlcycsXHJcbiAgICAncGFzY2FscHJlY2h0LnRyYW5zbGF0ZScsICAvLyBpbmplY3QgdGhlIGFuZ3VsYXItdHJhbnNsYXRlIG1vZHVsZVxyXG4gICAgJ3RtaC5keW5hbWljTG9jYWxlJywgLy8gaW5qZWN0IHRoZSBhbmd1bGFyLWR5bmFtaWMtbG9jYWxlIG1vZHVsZVxyXG4gICAgJ2lvbmljLXRvYXN0JywgLy8gdG9hc3RcclxuICAgICdjaGluZXNlbGVhcm4uY29udHJvbGxlcnMnLCAnY2hpbmVzZWxlYXJuLmRpcmVjdGl2ZXMnLCAnY2hpbmVzZWxlYXJuLmZpbHRlcnMnLCAnY2hpbmVzZWxlYXJuLnNlcnZpY2VzJyAvL2N1c3RvbXNcclxuICAgIF0pXHJcblxyXG4ucnVuKGZ1bmN0aW9uICgkaW9uaWNQbGF0Zm9ybSwgJGlvbmljSGlzdG9yeSwgaW9uaWNUb2FzdCwgJGZpbHRlciwgJHRpbWVvdXQpIHtcclxuXHJcbiAgICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyBIaWRlIHRoZSBhY2Nlc3NvcnkgYmFyIGJ5IGRlZmF1bHQgKHJlbW92ZSB0aGlzIHRvIHNob3cgdGhlIGFjY2Vzc29yeSBiYXIgYWJvdmUgdGhlIGtleWJvYXJkXHJcbiAgICAvLyBmb3IgZm9ybSBpbnB1dHMpXHJcbiAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucyAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zLktleWJvYXJkKSB7XHJcbiAgICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmhpZGVLZXlib2FyZEFjY2Vzc29yeUJhcih0cnVlKTtcclxuICAgIH07XHJcbiAgICBpZiAod2luZG93LlN0YXR1c0Jhcikge1xyXG4gICAgICAgIFN0YXR1c0Jhci5zdHlsZUxpZ2h0Q29udGVudCgpO1xyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgdmFyIGNvdW50VGltZXJGb3JDbG9zZUFwcCA9IGZhbHNlO1xyXG4gICRpb25pY1BsYXRmb3JtLnJlZ2lzdGVyQmFja0J1dHRvbkFjdGlvbihmdW5jdGlvbiAoZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIC8vIElzIHRoZXJlIGEgcGFnZSB0byBnbyBiYWNrIHRvP1xyXG4gICAgICB2YXIgcHJldmlvdXNWaWV3ID0gJGlvbmljSGlzdG9yeS5iYWNrVmlldygpO1xyXG4gICAgICBpZiAoIXByZXZpb3VzVmlldykge1xyXG4gICAgICAgICAgaWYgKGNvdW50VGltZXJGb3JDbG9zZUFwcCkge1xyXG4gICAgICAgICAgICAgIGlvbmljLlBsYXRmb3JtLmV4aXRBcHAoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgY291bnRUaW1lckZvckNsb3NlQXBwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBpb25pY1RvYXN0LnNob3coJGZpbHRlcigndHJhbnNsYXRlJykoJ0NPTkZJUk1fQkVGT1JFX0FQUF9FWElUJyksICdtaWRkbGUnLCBmYWxzZSwgMTAwMCk7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICBjb3VudFRpbWVyRm9yQ2xvc2VBcHAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHByZXZpb3VzVmlldy5nbygpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICB9LCAxMDEpO1xyXG4gIFxyXG59KVxyXG5cclxuLmNvbmZpZyhmdW5jdGlvbigkaW9uaWNDb25maWdQcm92aWRlciwgdG1oRHluYW1pY0xvY2FsZVByb3ZpZGVyLCAkdHJhbnNsYXRlUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgIC8vZ2xvYmFsIGNvbmZpZ3VyZVxyXG4gICAgJGlvbmljQ29uZmlnUHJvdmlkZXIudGFicy5wb3NpdGlvbignYm90dG9tJyk7XHJcblxyXG4gICAgLy9sb2NhbGUgbG9jYXRpb25cclxuICAgIHRtaER5bmFtaWNMb2NhbGVQcm92aWRlci5sb2NhbGVMb2NhdGlvblBhdHRlcm4oJ2xvY2FsZXMvYW5ndWxhci1sb2NhbGVfe3tsb2NhbGV9fS5qcycpO1xyXG5cclxuICAgIC8vIGkxOG5cclxuICAgICR0cmFuc2xhdGVQcm92aWRlclxyXG4gICAgICAudXNlU3RhdGljRmlsZXNMb2FkZXIoe1xyXG4gICAgICAgIHByZWZpeDogJ2kxOG4vJyxcclxuICAgICAgICBzdWZmaXg6ICcuanNvbidcclxuICAgICAgfSlcclxuICAgICAgLnJlZ2lzdGVyQXZhaWxhYmxlTGFuZ3VhZ2VLZXlzKFsnYXInLCAnYm4nLCAnZGUnLCAnZW4nLCAnZXMnLCAnZnInLCAnaGknLCAnaWQnLCAnamEnLCAnbXMnLCAncHQnLCAncnUnLCAndXInLCAnemgnXSwge1xyXG4gICAgICAgICAgJ2FyJzogJ2FyJywgJ2FyXyonOiAnYXInLFxyXG4gICAgICAgICAgJ2JuJzogJ2JuJywgJ2JuXyonOiAnYm4nLFxyXG4gICAgICAgICAgJ2RlJzogJ2RlJywgJ2RlXyonOiAnZGUnLFxyXG4gICAgICAgICAgJ2VuJzogJ2VuJywgJ2VuXyonOiAnZW4nLFxyXG4gICAgICAgICAgJ2VzJzogJ2VzJywgJ2VzXyonOiAnZXMnLFxyXG4gICAgICAgICAgJ2ZyJzogJ2ZyJywgJ2ZyXyonOiAnZnInLFxyXG4gICAgICAgICAgJ2hpJzogJ2hpJywgJ2hpXyonOiAnaGknLFxyXG4gICAgICAgICAgJ2lkJzogJ2lkJywgJ2lkXyonOiAnaWQnLFxyXG4gICAgICAgICAgJ2phJzogJ2phJywgJ2phXyonOiAnamEnLFxyXG4gICAgICAgICAgJ21zJzogJ21zJywgJ21zXyonOiAnbXMnLFxyXG4gICAgICAgICAgJ3B0JzogJ3B0JywgJ3B0XyonOiAncHQnLFxyXG4gICAgICAgICAgJ3J1JzogJ3J1JywgJ3J1XyonOiAncnUnLFxyXG4gICAgICAgICAgJ3VyJzogJ3VyJywgJ3VyXyonOiAndXInLFxyXG4gICAgICAgICAgJ3poJzogJ3poJywgJ3poXyonOiAnemgnXHJcbiAgICAgIH0pXHJcbiAgICAgIC5wcmVmZXJyZWRMYW5ndWFnZSgnZGUnKVxyXG4gICAgICAuZmFsbGJhY2tMYW5ndWFnZShbJ2VuJywgJ3poJywgJ2VzJywgJ2ZyJ10pXHJcbiAgICAgIC5kZXRlcm1pbmVQcmVmZXJyZWRMYW5ndWFnZSgpXHJcbiAgICAgIC51c2VTYW5pdGl6ZVZhbHVlU3RyYXRlZ3koJ2VzY2FwZVBhcmFtZXRlcnMnKVxyXG4gICAgICAudXNlTG9jYWxTdG9yYWdlKCk7XHJcblxyXG4gIC8vIElvbmljIHVzZXMgQW5ndWxhclVJIFJvdXRlciB3aGljaCB1c2VzIHRoZSBjb25jZXB0IG9mIHN0YXRlc1xyXG4gICRzdGF0ZVByb3ZpZGVyXHJcbiAgLy8gc2V0dXAgYW4gYWJzdHJhY3Qgc3RhdGUgZm9yIHRoZSB0YWJzIGRpcmVjdGl2ZVxyXG4gICAgLnN0YXRlKCd0YWInLCB7XHJcbiAgICB1cmw6IFwiL3RhYlwiLFxyXG4gICAgYWJzdHJhY3Q6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZVVybDogXCJ0ZW1wbGF0ZXMvdGFicy5odG1sXCJcclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi5kYXNoJywge1xyXG4gICAgdXJsOiAnL2Rhc2gnLFxyXG4gICAgdmlld3M6IHtcclxuICAgICAgICAndGFiLWRhc2gnOiB7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLWRhc2guaHRtbCcsXHJcbiAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hDdHJsJ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi5wb3N0cycsIHtcclxuICAgICAgICB1cmw6ICcvcG9zdHMnLFxyXG4gICAgICAgIGNhY2hlOiBmYWxzZSxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAndGFiLXBvc3RzJzoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLXBvc3RzLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi5wb3N0LWRldGFpbCcsIHtcclxuICAgICAgICB1cmw6ICcvcG9zdHMvOnBvc3RJZCcsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgJ3RhYi1wb3N0cyc6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3Bvc3QtZGV0YWlsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3REZXRhaWxDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5zdGF0ZSgndGFiLnRhZ3MnLCB7XHJcbiAgICAgICAgdXJsOiAnL3RhZ3MnLFxyXG4gICAgICAgIGNhY2hlOiBmYWxzZSxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAndGFiLXRhZ3MnOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90YWItdGFncy5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUYWdzQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi50YWctcG9zdHMnLCB7XHJcbiAgICAgICAgdXJsOiAnL3RhZ3Bvc3RzLzp0YWdTbHVnLzp0YWdOYW1lJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAndGFiLXBvc3RzJzoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLXBvc3RzLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi5jYXRlZ29yaWVzJywge1xyXG4gICAgICAgIHVybDogJy9jYXRlZ29yaWVzJyxcclxuICAgICAgICBjYWNoZTogZmFsc2UsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgJ3RhYi1jYXRlZ29yaWVzJzoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLWNhdGVnb3JpZXMuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnQ2F0ZWdvcmllc0N0cmwnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnN0YXRlKCd0YWIuY2F0ZWdvcnktcG9zdHMnLCB7XHJcbiAgICAgICAgdXJsOiAnL2NhdGVnb3J5cG9zdHMvOmNhdGVnb3J5U2x1Zy86Y2F0ZWdvcnlOYW1lJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAndGFiLXBvc3RzJzoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLXBvc3RzLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuc3RhdGUoJ3RhYi5hY2NvdW50Jywge1xyXG4gICAgdXJsOiAnL2FjY291bnQnLFxyXG4gICAgdmlld3M6IHtcclxuICAgICAgICAndGFiLWFjY291bnQnOiB7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLWFjY291bnQuaHRtbCcsXHJcbiAgICAgICAgY29udHJvbGxlcjogJ0FjY291bnRDdHJsJ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAvLyBpZiBub25lIG9mIHRoZSBhYm92ZSBzdGF0ZXMgYXJlIG1hdGNoZWQsIHVzZSB0aGlzIGFzIHRoZSBmYWxsYmFja1xyXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy90YWIvZGFzaCcpO1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnY2hpbmVzZWxlYXJuLmNvbnRyb2xsZXJzJywgW10pXHJcblxyXG4uY29udHJvbGxlcignRGFzaEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7fSlcclxuXHJcbi5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBEYXRhTG9hZGVyLCAkc3RhdGVQYXJhbXMsICR0aW1lb3V0LCAkbG9nLCAkZmlsdGVyLCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNIaXN0b3J5KSB7XHJcbiAgICAkaW9uaWNMb2FkaW5nLnNob3coe1xyXG4gICAgICAgIHRlbXBsYXRlOiAkZmlsdGVyKCd0cmFuc2xhdGUnKSgnTE9BRElOR19URVhUJylcclxuICAgIH0pO1xyXG4gICAgJHNjb3BlLlJTZW1wdHkgPSBmYWxzZTtcclxuXHJcbiAgICAvLyBHZXQgYWxsIG9mIG91ciBwb3N0cyBbdW5kZXIgUGFyYW1zIGNvbnN0cmFpbnRdXHJcbiAgICB2YXIgdGVybVF1ZXJ5U3RyaW5nO1xyXG4gICAgaWYgKCRzdGF0ZVBhcmFtcy50YWdTbHVnKSB7XHJcbiAgICAgICAgdGVybVF1ZXJ5U3RyaW5nID0gJz9maWx0ZXJbdGFnXT0nICsgJHN0YXRlUGFyYW1zLnRhZ1NsdWc7XHJcbiAgICAgICAgJHNjb3BlLnRlcm1RUyA9IHsgVHlwZTogJ1RBQl9USVRMRV9UQUdTJywgVGVybTogJHN0YXRlUGFyYW1zLnRhZ05hbWUgfTtcclxuICAgIH0gZWxzZSBpZiAoJHN0YXRlUGFyYW1zLmNhdGVnb3J5U2x1Zykge1xyXG4gICAgICAgIHRlcm1RdWVyeVN0cmluZyA9ICc/ZmlsdGVyW2NhdGVnb3J5X25hbWVdPScgKyAkc3RhdGVQYXJhbXMuY2F0ZWdvcnlTbHVnO1xyXG4gICAgICAgICRzY29wZS50ZXJtUVMgPSB7IFR5cGU6ICdUQUJfVElUTEVfQ0FURUdPUklFUycsIFRlcm06ICRzdGF0ZVBhcmFtcy5jYXRlZ29yeU5hbWUgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9UT0RPOiBpbml0aWFsIHRvIGdldCBhbGwgd2hpbGUgY2xpY2sgb3JpZ2luYWwgdGFiIG9mIFwiUE9TVFNcIlxyXG4gICAgICAgIHRlcm1RdWVyeVN0cmluZyA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgICRzY29wZS5sb2FkUG9zdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgRGF0YUxvYWRlci5nZXQoJ3Bvc3RzJyArIHRlcm1RdWVyeVN0cmluZykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnBvc3RzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XHJcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5lcnJvcignZXJyb3InLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xyXG4gICAgICAgICAgICAkc2NvcGUuUlNlbXB0eSA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9hZCBwb3N0cyBvbiBwYWdlIGxvYWRcclxuICAgICRzY29wZS5sb2FkUG9zdHMoKTtcclxuXHJcbiAgICAvLyBQdWxsIHRvIHJlZnJlc2hcclxuICAgICRzY29wZS5kb1JlZnJlc2ggPSBmdW5jdGlvbigpIHtcclxuICBcclxuICAgICAgICAkdGltZW91dCggZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLnNob3coe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICRmaWx0ZXIoJ3RyYW5zbGF0ZScpKCdMT0FESU5HX1RFWFQnKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJHNjb3BlLmxvYWRQb3N0cygpO1xyXG5cclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgXHJcbiAgICB9O1xyXG4gICAgXHJcbn0pXHJcblxyXG4uY29udHJvbGxlcignUG9zdERldGFpbEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIERhdGFMb2FkZXIsICRzY2UsICR0aW1lb3V0LCAkbG9nLCAkZmlsdGVyLCAkaW9uaWNMb2FkaW5nKSB7XHJcbiAgICAkaW9uaWNMb2FkaW5nLnNob3coe1xyXG4gICAgICAgIHRlbXBsYXRlOiAkZmlsdGVyKCd0cmFuc2xhdGUnKSgnTE9BRElOR19URVhUJylcclxuICAgIH0pO1xyXG4gICAgJHNjb3BlLlJTZW1wdHkgPSBmYWxzZTtcclxuXHJcbiAgICAkc2NvcGUubG9hZFBvc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBEYXRhTG9hZGVyLmdldCgncG9zdHMvJyArICRzdGF0ZVBhcmFtcy5wb3N0SWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wb3N0ID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgLy8gRG9uJ3Qgc3RyaXAgcG9zdCBodG1sXHJcbiAgICAgICAgICAgICRzY29wZS5jb250ZW50ID0gJHNjZS50cnVzdEFzSHRtbChyZXNwb25zZS5kYXRhLmNvbnRlbnQucmVuZGVyZWQpO1xyXG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcclxuICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmVycm9yKCdlcnJvcicsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgJHNjb3BlLmxvYWRQb3N0KCk7XHJcblxyXG4gICAgLy8gUHVsbCB0byByZWZyZXNoXHJcbiAgICAkc2NvcGUuZG9SZWZyZXNoID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHRpbWVvdXQoIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubG9hZFBvc3QoKTtcclxuICAgICAgICB9LCAxMDAwKTtcclxuICAgIH07XHJcbn0pXHJcblxyXG5cclxuLmNvbnRyb2xsZXIoJ1RhZ3NDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgRGF0YUxvYWRlciwgJHRpbWVvdXQsICRsb2csICRmaWx0ZXIsICRpb25pY0xvYWRpbmcpIHtcclxuICAgICRpb25pY0xvYWRpbmcuc2hvdyh7XHJcbiAgICAgICAgdGVtcGxhdGU6ICRmaWx0ZXIoJ3RyYW5zbGF0ZScpKCdMT0FESU5HX1RFWFQnKVxyXG4gICAgfSk7XHJcbiAgICAkc2NvcGUuUlNlbXB0eSA9IGZhbHNlO1xyXG5cclxuICAgICRzY29wZS5sb2FkVGFncyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBEYXRhTG9hZGVyLmdldCgndGFncycpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS50YWdzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ2Vycm9yJywgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcclxuICAgICAgICAgICAgJHNjb3BlLlJTZW1wdHkgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgICRzY29wZS5sb2FkVGFncygpO1xyXG5cclxuICAgIC8vIFB1bGwgdG8gcmVmcmVzaFxyXG4gICAgJHNjb3BlLmRvUmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2FkVGFncygpO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgfTtcclxufSlcclxuXHJcblxyXG4uY29udHJvbGxlcignQ2F0ZWdvcmllc0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBEYXRhTG9hZGVyLCAkdGltZW91dCwgJGxvZywgJGZpbHRlciwgJGlvbmljTG9hZGluZykge1xyXG4gICAgJGlvbmljTG9hZGluZy5zaG93KHtcclxuICAgICAgICB0ZW1wbGF0ZTogJGZpbHRlcigndHJhbnNsYXRlJykoJ0xPQURJTkdfVEVYVCcpXHJcbiAgICB9KTtcclxuICAgICRzY29wZS5SU2VtcHR5ID0gZmFsc2U7XHJcblxyXG4gICAgJHNjb3BlLmxvYWRDYXRlZ29yaWVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIERhdGFMb2FkZXIuZ2V0KCdjYXRlZ29yaWVzJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNhdGVnb3JpZXMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcclxuICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5lcnJvcignZXJyb3InLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xyXG4gICAgICAgICAgICAkc2NvcGUuUlNlbXB0eSA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgJHNjb3BlLmxvYWRDYXRlZ29yaWVzKCk7XHJcblxyXG4gICAgLy8gUHVsbCB0byByZWZyZXNoXHJcbiAgICAkc2NvcGUuZG9SZWZyZXNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxvYWRDYXRlZ29yaWVzKCk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICB9O1xyXG59KVxyXG5cclxuXHJcbi5jb250cm9sbGVyKCdBY2NvdW50Q3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICR0cmFuc2xhdGUsIHRtaER5bmFtaWNMb2NhbGUsIEFwcFNldHRpbmdzLCAkaW9uaWNIaXN0b3J5LCBFbWFpbFNlbmRlciwgJGZpbHRlciwgJGxvZykge1xyXG4gICAgJHNjb3BlLmZvcm1zID0ge307XHJcbiAgICAkc2NvcGUuY3RGb3JtID0ge307XHJcbiAgICAkc2NvcGUuc2V0dGluZ3MgPSB7XHJcbiAgICAgIGVuYWJsZUZyaWVuZHM6IHRydWUsXHJcbiAgICAgIGxhbmd1YWdlOiAkdHJhbnNsYXRlLnVzZSgpXHJcbiAgfVxyXG5cclxuICAkc2NvcGUuJHdhdGNoKCdzZXR0aW5ncy5sYW5ndWFnZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgQXBwU2V0dGluZ3MuY2hhbmdlKCdsYW5ndWFnZScsICRzY29wZS5zZXR0aW5ncy5sYW5ndWFnZSk7XHJcbiAgICAgICRpb25pY0hpc3RvcnkuY2xlYXJDYWNoZSgpO1xyXG4gICAgICAkaW9uaWNIaXN0b3J5LmNsZWFySGlzdG9yeSgpO1xyXG4gIH0pO1xyXG5cclxuICAgIC8vIGNvbnRhY3QgZm9ybSBzdWJtaXR0aW5nXHJcbiAgJHNjb3BlLmZvcm1TdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgdmFyIG1haWxKU09OID0ge1xyXG4gICAgICAgICAgXCJrZXlcIjogQXBwU2V0dGluZ3MuZ2V0KCdlbWFpbHNlcnZpY2VLZXknKSxcclxuICAgICAgICAgIFwibWVzc2FnZVwiOiB7XHJcbiAgICAgICAgICAgICAgXCJodG1sXCI6ICRzY29wZS5jdEZvcm0uY3RNZXNzYWdlLFxyXG4gICAgICAgICAgICAgIFwidGV4dFwiOiAkc2NvcGUuY3RGb3JtLmN0TWVzc2FnZSxcclxuICAgICAgICAgICAgICBcInN1YmplY3RcIjogXCJNZXNzYWdlIHNlbnQgdmlhIE1vYmlsZSBBUFAgLSBDaGluZXNlTGVhcm4uaW5mbywgXCIgKyAkZmlsdGVyKCdkYXRlJykoRGF0ZS5ub3coKSwgJ3l5eXktTU0tZGQgSEg6bW06c3MgWicpLFxyXG4gICAgICAgICAgICAgIFwiZnJvbV9lbWFpbFwiOiAkc2NvcGUuY3RGb3JtLmN0RW1haWwsXHJcbiAgICAgICAgICAgICAgXCJmcm9tX25hbWVcIjogJHNjb3BlLmN0Rm9ybS5jdE5hbWUsXHJcbiAgICAgICAgICAgICAgXCJ0b1wiOiBbXHJcbiAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIjogQXBwU2V0dGluZ3MuZ2V0KCdjb250YWN0Rm9ybTJFbWFpbCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IEFwcFNldHRpbmdzLmdldCgnY29udGFjdEZvcm0yVXNlcicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwidG9cIlxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICBcImltcG9ydGFudFwiOiBmYWxzZSxcclxuICAgICAgICAgICAgICBcInRyYWNrX29wZW5zXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgXCJ0cmFja19jbGlja3NcIjogbnVsbCxcclxuICAgICAgICAgICAgICBcImF1dG9fdGV4dFwiOiBudWxsLFxyXG4gICAgICAgICAgICAgIFwiYXV0b19odG1sXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgXCJpbmxpbmVfY3NzXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgXCJ1cmxfc3RyaXBfcXNcIjogbnVsbCxcclxuICAgICAgICAgICAgICBcInByZXNlcnZlX3JlY2lwaWVudHNcIjogbnVsbCxcclxuICAgICAgICAgICAgICBcInZpZXdfY29udGVudF9saW5rXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgXCJ0cmFja2luZ19kb21haW5cIjogbnVsbCxcclxuICAgICAgICAgICAgICBcInNpZ25pbmdfZG9tYWluXCI6IG51bGwsXHJcbiAgICAgICAgICAgICAgXCJyZXR1cm5fcGF0aF9kb21haW5cIjogbnVsbFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIFwiYXN5bmNcIjogZmFsc2UsXHJcbiAgICAgICAgICBcImlwX3Bvb2xcIjogXCJNYWluIFBvb2xcIlxyXG4gICAgICB9O1xyXG4gICAgICBFbWFpbFNlbmRlci5zZW5kKG1haWxKU09OKTtcclxuICAgICAgYWxlcnQoJGZpbHRlcigndHJhbnNsYXRlJykoJ0FMRVJUX01BSUxfU0VOVCcsIHsgbmFtZTogJHNjb3BlLmN0Rm9ybS5jdE5hbWUgfSkpO1xyXG5cclxuICAgICAgLy9yZXNldCBGb3JtXHJcbiAgICAgICRzY29wZS5jdEZvcm0gPSB7fTtcclxuICAgICAgJHNjb3BlLmZvcm1zLmNvbnRhY3RGb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnY2hpbmVzZWxlYXJuLmRpcmVjdGl2ZXMnLCBbXSlcclxuXHJcbi8vIFNldCB1cCBmb3IgZ3JvdXBlZCBSYWRpbyBCdXR0b25zXHJcbi5kaXJlY3RpdmUoJ2dwUmFkaW8nLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgIG1vZGVsOiAnPW5nTW9kZWwnLFxyXG4gICAgICAgICAgICB2YWx1ZTogJz1ncFJhZGlvJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbEN0cmwpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnYnV0dG9uJyk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZShzY29wZS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2goJ21vZGVsJywgZnVuY3Rpb24gKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnYnV0dG9uLXBvc2l0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VmFsID09PSBzY29wZS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2J1dHRvbi1wb3NpdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnY2hpbmVzZWxlYXJuLmZpbHRlcnMnLCBbXSlcclxuXHJcbi5maWx0ZXIoJ2xpbmtyZW1vdmUnLCBmdW5jdGlvbiAoJHNjZSwgJGxvZykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgdmFyIGh0bWxPYmplY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBodG1sT2JqZWN0LmlubmVySFRNTCA9IHRleHQ7XHJcblxyXG4gICAgICAgIHZhciBsaW5rcyA9IGh0bWxPYmplY3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gbGlua3MubGVuZ3RoOyBpID4gMCA7IGktLSkge1xyXG4gICAgICAgICAgICBsaW5rc1tpLTFdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGlua3NbaS0xXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbChodG1sT2JqZWN0Lm91dGVySFRNTCk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG4uZmlsdGVyKCdsaW5rcmVtb3ZlX2ltYWdlbGF6eWxvYWQnLCBmdW5jdGlvbiAoJHNjZSwgJGxvZykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XHJcbiAgICAgICAgdmFyIGh0bWxPYmplY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBodG1sT2JqZWN0LmlubmVySFRNTCA9IHRleHQ7XHJcblxyXG4gICAgICAgIC8vIHJlbW92ZSBsaW5rc1xyXG4gICAgICAgIHZhciBsaW5rcyA9IGh0bWxPYmplY3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gbGlua3MubGVuZ3RoOyBpID4gMCA7IGktLSkge1xyXG4gICAgICAgICAgICBsaW5rc1tpLTFdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGlua3NbaS0xXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjaGFuZ2UgaW1hZ2UgYXR0cmlidXRlc1xyXG4gICAgICAgIHZhciBpbWdzID0gaHRtbE9iamVjdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1nJyk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAgOyBpIDwgaW1ncy5sZW5ndGgtMSA7IGkrKykge1xyXG4gICAgICAgICAgICBpbWdzW2ldLnNldEF0dHJpYnV0ZSgnaW1hZ2UtbGF6eS1zcmMnLCBpbWdzW2ldLmdldEF0dHJpYnV0ZSgnc3JjJykpO1xyXG4gICAgICAgICAgICBpbWdzW2ldLnNldEF0dHJpYnV0ZSgnbGF6eS1zY3JvbGwtcmVzaXplJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGltZ3NbaV0ucmVtb3ZlQXR0cmlidXRlKCdzcmMnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKGh0bWxPYmplY3Qub3V0ZXJIVE1MKTtcclxuICAgIH1cclxufSlcclxuXHJcbi5maWx0ZXIoJ3VuaWNvZGUnLCBmdW5jdGlvbiAoJHNjZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwoeCk7XHJcbiAgICB9XHJcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2NoaW5lc2VsZWFybi5zZXJ2aWNlcycsIFtdKVxyXG5cclxuLmZhY3RvcnkoJ0RhdGFMb2FkZXInLCBmdW5jdGlvbiAoJGh0dHAsICRsb2csIEFwcFNldHRpbmdzKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCR0ZXJtKSB7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSBBcHBTZXR0aW5ncy5nZXRVUkkoKSArICR0ZXJtO1xyXG4gICAgICAgICAgICAkbG9nLmRlYnVnKCdVUkw6ICcgKyB1cmwpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KVxyXG5cclxuLmZhY3RvcnkoJ0VtYWlsU2VuZGVyJywgZnVuY3Rpb24gKCRodHRwLCAkbG9nLCBBcHBTZXR0aW5ncykge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzZW5kOiBmdW5jdGlvbiAoJG1haWwpIHtcclxuICAgICAgICAgICAgJGh0dHAucG9zdChBcHBTZXR0aW5ncy5nZXQoJ2VtYWlsQVBJJyksICRtYWlsKS5cclxuICAgICAgICAgICAgc3VjY2VzcyhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkbG9nLmRlYnVnKCdzdWNjZXNzZnVsIGVtYWlsIHNlbmQuJyk7XHJcbiAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRsb2cuZGVidWcoJ2Vycm9yIHNlbmRpbmcgZW1haWwuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pXHJcblxyXG4uZmFjdG9yeSgnQXBwU2V0dGluZ3MnLCBmdW5jdGlvbiAoJHRyYW5zbGF0ZSwgdG1oRHluYW1pY0xvY2FsZSwgJGxvZykge1xyXG4gICAgdmFyIHNhdmVkRGF0YSA9IHtcclxuICAgICAgICBkb21haW5VUkk6ICdodHRwczovL2NoaW5lc2VsZWFybi5pbmZvLycsXHJcbiAgICAgICAgd3Bqc29uVVJJOiAnd3AtanNvbi93cC92Mi8nLFxyXG4gICAgICAgIGVuYWJsZUZyaWVuZHM6IHRydWUsXHJcbiAgICAgICAgbGFuZ3VhZ2U6ICcnLFxyXG4gICAgICAgIGxhbmd1YWdlVVJJOiAnJyxcclxuICAgICAgICBlbWFpbHNlcnZpY2VLZXk6ICdlOHlDblVjZzFPYUt6MGRXSWhJSDd3JyxcclxuICAgICAgICBlbWFpbEFQSTogJ2h0dHBzOi8vbWFuZHJpbGxhcHAuY29tL2FwaS8xLjAvbWVzc2FnZXMvc2VuZC5qc29uJyxcclxuICAgICAgICBjb250YWN0Rm9ybTJFbWFpbDogJ3N1cHBvcnRAY2hpbmVzZWxlYXJuLmluZm8nLFxyXG4gICAgICAgIGNvbnRhY3RGb3JtMlVzZXI6ICdTdXBwb3J0JyxcclxuICAgICAgICBkYXRkUmVsb2FkOiBmYWxzZVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBzZXRMYW5ndWFnZVVSSSh2YWx1ZSkge1xyXG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgICAgY2FzZSAnZW4nOlxyXG4gICAgICAgICAgICAgICAgc2F2ZWREYXRhLmxhbmd1YWdlVVJJID0gJyc7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnemgnOlxyXG4gICAgICAgICAgICAgICAgc2F2ZWREYXRhLmxhbmd1YWdlVVJJID0gJ3poLWhhbnQvJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgc2F2ZWREYXRhLmxhbmd1YWdlVVJJID0gdmFsdWUgKyAnLyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldCBMYW5ndWFnZSBhbmQgTGFuZ3VhZ2VVUklcclxuICAgIHNhdmVkRGF0YS5sYW5ndWFnZSA9ICR0cmFuc2xhdGUudXNlKCk7XHJcbiAgICBzZXRMYW5ndWFnZVVSSShzYXZlZERhdGEubGFuZ3VhZ2UpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY2hhbmdlOiBmdW5jdGlvbiAoJGl0ZW0sIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHNhdmVkRGF0YVskaXRlbV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgaWYgKCRpdGVtID09ICdsYW5ndWFnZScpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNldCBMYW5ndWFnZSBVUklcclxuICAgICAgICAgICAgICAgIHNldExhbmd1YWdlVVJJKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IFRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgJHRyYW5zbGF0ZS51c2UodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgdG1oRHluYW1pY0xvY2FsZS5zZXQodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRsb2cuZGVidWcoJGl0ZW0gKyAnIDogJyArIHZhbHVlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCRpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzYXZlZERhdGFbJGl0ZW1dO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0VVJJOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzYXZlZERhdGEuZG9tYWluVVJJICsgc2F2ZWREYXRhLmxhbmd1YWdlVVJJICsgc2F2ZWREYXRhLndwanNvblVSSTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
